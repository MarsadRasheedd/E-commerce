<h3 style="text-align: center;">All Products</h3>
<%= link_to 'New Product', new_product_path, class: "float-right mr-3" %>

<div style="display: flex; mt-5">
  <% @products.each do |product| %>
    <div class="card product-card" style="border-radius: 20px">
      <%= image_tag product.images.first, style:"height: 15rem; border-radius: 20px;" if product.images.attached? %>
      <div class="card-body text-center pb-0">
        <h4><%= product.title %></h4>
        <p><%= product.description %></p>
        <p>$<%= product.price %></p>
      </div>

      <div class="d-flex justify-content-center">

        <%= form_for(@cart_item) do |f|%>
          <%= f.hidden_field :product_id, style:"width: 0px;",  value: product.id %>
          <% if user_signed_in? %>
            <%= f.hidden_field :cartt_id, style:"width: 0px;", value: Cartt.find_by_user_id(current_user.id).id %>
          <% else %>
            <%= f.hidden_field :cartt_id, style:"width: 0px;",  value: product.id %>
          <% end %>

          <div class="mb-2">
            <button id="decrement_btn-<%=product.id%>" type="button", data-quantity="<%= $quantity %>" class="btn btn-primary" >-</button>
            <%= f.text_field :quantity, value:1, style:"width: 30px; text-align:center; border:none", id: ("quantity_field-"+product.id.to_s) %>
            <button id="increment_btn-<%=product.id%>", type="button", data-myvalue="<%= $quantity %>" class="btn btn-primary">+</button>
          </div>

          <%= f.submit "Add To Cart", class: "btn btn-success" %>
        <% end %>
      </div>

      <div class="card_links" id="view_product">
        <%= link_to 'View Product â†’', product %>
      </div>
    </div>

    <script>
      $("#increment_btn-<%=product.id%>").click(function(){
        let value = parseInt($("#quantity_field-<%=product.id%>").val());
        $("#quantity_field-<%=product.id%>").val(value + 1);
      });

      $("#decrement_btn-<%=product.id%>").click(function(){
        let value = parseInt($("#quantity_field-<%=product.id%>").val());
        if (value > 1) {
        $("#quantity_field-<%=product.id%>").val(value - 1);
        }
      });
    </script>
  <% end %>
</div>
